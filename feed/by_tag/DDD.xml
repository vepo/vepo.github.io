<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.2.2">Jekyll</generator><link href="https://blog.vepo.dev/feed/by_tag/DDD.xml" rel="self" type="application/atom+xml" /><link href="https://blog.vepo.dev/" rel="alternate" type="text/html" /><updated>2026-02-21T19:42:20+00:00</updated><id>https://blog.vepo.dev/feed/by_tag/DDD.xml</id><title type="html">vepo</title><subtitle>Um reposit√≥rio para todos os posts, palestras e tutoriais que j√° fiz. Java, Desenvolvimento de Software e reflex√µes sobre filosofia</subtitle><author><name>{&quot;twitter&quot;=&gt;&quot;vepo&quot;, &quot;linkedin&quot;=&gt;&quot;https://www.linkedin.com/in/victorosorio/&quot;, &quot;picture&quot;=&gt;&quot;/assets/images/me.avif&quot;}</name></author><entry><title type="html">Elementos do Design de Software</title><link href="https://blog.vepo.dev/posts/ddd-02-elementos-do-design-de-software" rel="alternate" type="text/html" title="Elementos do Design de Software" /><published>2022-09-28T00:00:00+00:00</published><updated>2022-09-28T00:00:00+00:00</updated><id>https://blog.vepo.dev/posts/00-00-00-elementos-do-design-de-software</id><content type="html" xml:base="https://blog.vepo.dev/posts/ddd-02-elementos-do-design-de-software"><![CDATA[<div class="paragraph">
<p>Esse post faz parte de uma s√©rie sobre Domain-Driven Design, se voc√™ n√£o leu os posts anteriores, recomendo ler antes de seguir com a leitura. Nesse vamos expandir o nosso vocabul√°rio de Design de Software detalhando alguns elementos (<em>building blocks</em>) de design.</p>
</div>
<div class="sect1">
<h2 id="experiencia-e-vivencia">Experi√™ncia e Viv√™ncia</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Quando come√ßamos a escrever software enfrentamos um grande desafio que √© n√£o saber dar nomes as coisas. Estamos muito focados em aprender estruturas de dados, sintaxes e bibliotecas. Nosso repert√≥rio √© formado por tudo aquilo que vimos e em muitos casos foram apenas alguns exemplos que demonstram funcionalidades da linguagem. Falamos de listas, arrays, Strings, inteiros, float e booleans, mas n√£o sabemos como abstrair a partir desse ponto.</p>
</div>
<div class="paragraph">
<p><em>‚Äî √â mesmo! Eu vejo o trabalho de pessoa mais velhas e acho que nunca vou conseguir fazer algo igual!</em></p>
</div>
<div class="paragraph">
<p>Mas sabe qual √© a diferen√ßa entre algu√©m mais velho na √°rea e algu√©m que entrou agora? Experi√™ncia. Experi√™ncia traz vocabul√°rio, vocabul√°rio expande nossas capacidades de ver e compreender o mundo. Quanto mais projetos n√≥s trabalhamos mais capacidade temos de compreender o que est√° acontecendo ao nosso redor.</p>
</div>
<div class="paragraph">
<p>E essa li√ß√£o n√£o deve se limita ao <strong>of√≠cio</strong> de desenvolvimento de software, ela deve ser hol√≠stica, isso √©, deve englobar o todo da sua vida. Sabe porque eu grifei a palavra <strong>of√≠cio</strong>? Porque o desenvolvimento de software √© apenas um trabalho como todos os outros, mas ele deve intercambiar conhecimento com os outros trabalhos. Devemos aprender a perguntar e dar nomes a trabalhos e of√≠cios, pois no final estamos codificando experi√™ncias do mundo real.</p>
</div>
<div class="paragraph">
<p>Podemos definir que todo o trabalho do desenvolvimento de software √© automatizar corretamente atividades que existem hoje e est√£o em plena opera√ß√£o. Antes de existir aplicativos de entrega de comida, j√° existia entrega de comida e vai continuar existindo se um dia os aplicativos deixarem de existir. O trabalho √© sempre o mesmo, um cliente entra em contato com algu√©m que vende comida, a pessoa que vende comida contrata um entregador e esse deve tra√ßar uma rota para otimizar a entrega.</p>
</div>
<div class="paragraph">
<p>(<em>N√£o pense que isso √© algo moderno. Na cidade da minha av√≥ tinha um senhor que a vida toda entregou p√£o de casa em casa at√© quando existia uma √öNICA CENTRAL TELEF√îNICA na cidade. SIM! L√° nos anos 80 nas pequenas cidades do nordeste se precis√°ssemos ligar pra capital precisava ir na central telef√¥nica que era em uma pra√ßa. N√ÉO! N√£o foi a privatiza√ß√£o do sistema de telefonia que popularizou o telefone, isso aconteceu um pouco antes de privatizar.</em>)</p>
</div>
<div class="paragraph">
<p>Logo, modelar software envolve conhecimento do mundo real e esse conhecimento deve ser destilado usando estruturas e tipos de dados do mundo do software. Para ajudar nessa modelagem vamos ver algumas categorias de elementos que podemos usar em nosso software. Um software sempre ser√° composto por elementos que podem ser categorizados como Entidades, Objetos de Valor, Servi√ßos e M√≥dulos.</p>
</div>
<div class="paragraph">
<p>Essa atividade de caracterizar algo √© o que a filosofia chama de Ontologia, ou seja, a busca pela natureza do ser, da exist√™ncia e da realidade. N√£o precisamos ser fil√≥sofos e conhecer toda a hist√≥ria da filosofia, mas √© sempre bom treinar o modo de fazer filosofia pois modelar software √© um processo filos√≥fico. No momento que come√ßamos a pensar e questionar o que s√£o e o que fazem estruturas reais para modelar elas em uma forma de conhecimento, estamos praticando filosofia.</p>
</div>
<div id="filosofia" class="imageblock text-center text-center">
<div class="content">
<img src="/assets/images/filosofia.avif" alt="filosofia">
</div>
<div class="title">Figura 1. A Escola de Atenas (Scuola di Atenas, no original) de Rafael. Cont√©m uma representa√ß√£o dos grandes fil√≥sofos cl√°ssicos e dicas sobre seu discurso.</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="definindo-categorias">Definindo Categorias</h2>
<div class="sectionbody">
<div class="paragraph">
<p>J√° que vamos criar nosso modelo usando 4 categorias de elementos precisamos entender o que s√£o essas categorias e como identificar elas na linguagem que estamos usando no nosso software. Para come√ßar vamos jogar v√°rias senten√ßas que poderiam fazer parte dos requisitos de um projeto de software para cl√≠nica m√©dica e depois vamos trabalhar com esse dom√≠nio para tentar o modelar. Isso √© um exerc√≠cio de imagina√ß√£o, n√£o foi feito nenhum levantamento de requisitos, logo s√£o apenas requisitos hipot√©ticos.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>"Durante a consulta o m√©dico/m√©dica far√° a anamnese do paciente"</p>
</li>
<li>
<p>"A anamnese consiste de uma s√©rie de perguntas que o m√©dico/m√©dica faz para tentar chegar a um diagn√≥stico"</p>
</li>
<li>
<p>"O m√©dico/m√©dica pode pedir exames para chegar a um diagn√≥stico"</p>
</li>
<li>
<p>"A anamnese √© usada para avaliar a evolu√ß√£o do paciente"</p>
</li>
<li>
<p>"O diagn√≥stico pode levar v√°rias consultas para ser feito"</p>
</li>
<li>
<p>"O prontu√°rio de um paciente √© composto de todas as informa√ß√µes coletadas"</p>
</li>
<li>
<p>"Um m√©dico/m√©dica pode compartilha um prontu√°rio de um paciente, mas deve escolher quais informa√ß√µes v√£o ser compartilhadas"</p>
</li>
<li>
<p>"O prontu√°rio √© estritamente sigiloso. Somente o m√©dico/m√©dica pode ter acesso e s√≥ pode ser compartilhada para outro m√©dico/m√©dica que atende ao mesmo paciente."</p>
</li>
<li>
<p>"A consulta pode ser marcada pelo paciente diretamente pelo site"</p>
</li>
<li>
<p>"Se o paciente n√£o comparecer a consulta, deve ser cobrada uma taxa dele, mesmo que seja por plano"</p>
</li>
<li>
<p>"O reagendamento de consulta pode ser feito pelo m√©dico/m√©dica ou secret√°rio/secret√°ria e deve ser aprovado pelo paciente"</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A primeira atividade que precisamos fazer √© identificar todos os substantivos e verbos que fazem parte do nosso modelo. Todo substantivo pode executar uma atividade ativamente ou fazer parte de uma atividade passivamente, a atividade ser√° definida pelo verbo. Ent√£o vamos rever a lista de requisitos marcando todo substantivo?</p>
</div>
<div class="ulist">
<ul>
<li>
<p>"Durante a <strong>consulta</strong> o <strong>m√©dico/m√©dica</strong> far√° a <strong>anamnese</strong> do <strong>paciente</strong>"</p>
</li>
<li>
<p>"A <strong>anamnese</strong> consiste de uma s√©rie de <strong>perguntas</strong> que o <strong>m√©dico/m√©dica</strong> faz para tentar chegar a um <strong>diagn√≥stico</strong>"</p>
</li>
<li>
<p>"O <strong>m√©dico/m√©dica</strong> pode pedir <strong>exames</strong> para chegar a um <strong>diagn√≥stico</strong>"</p>
</li>
<li>
<p>"A <strong>anamnese</strong> √© usada para avaliar a <strong>evolu√ß√£o</strong> do <strong>paciente</strong>"</p>
</li>
<li>
<p>"O <strong>diagn√≥stico</strong> pode levar v√°rias <strong>consultas</strong> para ser feito"</p>
</li>
<li>
<p>"O <strong>prontu√°rio</strong> de um paciente √© composto de todas as <strong>informa√ß√µes</strong> coletadas"</p>
</li>
<li>
<p>"Um <strong>m√©dico/m√©dica</strong> pode compartilha um <strong>prontu√°rio</strong> de um <strong>paciente</strong>, mas deve escolher quais <strong>informa√ß√µes</strong> v√£o ser compartilhadas"</p>
</li>
<li>
<p>"O <strong>prontu√°rio</strong> √© estritamente sigiloso. Somente o <strong>m√©dico/m√©dica</strong> pode ter acesso e s√≥ pode ser compartilhada para outro <strong>m√©dico/m√©dica</strong> que atende ao mesmo <strong>paciente</strong>."</p>
</li>
<li>
<p>"A <strong>consulta</strong> pode ser marcada pelo <strong>paciente</strong> diretamente pelo site"</p>
</li>
<li>
<p>"Se o <strong>paciente</strong> n√£o comparecer a <strong>consulta</strong>, deve ser cobrada uma <strong>taxa</strong> dele, mesmo que seja por <strong>plano</strong>"</p>
</li>
<li>
<p>"O reagendamento de <strong>consulta</strong> pode ser feito pelo <strong>m√©dico/m√©dica</strong> ou <strong>secret√°rio/secret√°ria</strong> e deve ser aprovado pelo <strong>paciente</strong>"</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Os substantivos selecionados acima v√£o nos ajudar a entender os dois primeiros elementos de um modelo de neg√≥cios usando DDD: Entidades e Objetos de Valor. Ent√£o vamos ver a defini√ß√£o de cada um? Primeiro vamos ver o que o livro do Eric Evans fala sobre eles.</p>
</div>
<div id="pexels-medico-paciente" class="imageblock text-center text-center">
<div class="content">
<img src="/assets/images/pexels-medico-paciente.jpg" alt="pexels medico paciente">
</div>
<div class="title">Figura 2. Uma m√©dica conversando com um Paciente, imagem do Pexels.com.</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Entidades</div>
Alguns objetos n√£o s√£o definidos principalmente por seus atributos. Eles representam uma linha de identidade que atravessa o tempo e geralmente representa√ß√µes distintas. √Äs vezes, um objeto como esse pode ser combinado com outros objetos, embora os atributos possam diferir. Um objeto deve ser distinguido de outros objetos, embora eles possam ter os mesmos atributos. Um erro de identidade pode levar √† dados corrompidos.
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Objetos de Valor</div>
Quando voc√™ s√≥ se preocupa com os atributos de um elemento do modelo, classifique-o como um OBJETO DE VALOR. Fa√ßa com que ele expresse o significado dos atributos que ele transmite e d√™ a ele uma funcionalidade relacionada. Trate o OBJETO DE VALOR como imut√°vel. N√£o d√™ a ele nenhuma identidade e evite complexidades de design desnecess√°rias para manter ENTIDADES.
</div>
</div>
<div class="paragraph">
<p>Pode parecer confuso, e realmente √©, por isso vou tentar reescrever o que ele quer dizer com minhas pr√≥prias palavras.</p>
</div>
<div class="paragraph">
<p>Uma <strong>Entidade</strong> √© um objeto do modelo de neg√≥cios que tem sua identidade pr√≥pria definida apesar valores definido nela. Os valores podem e v√£o mudar com o tempo pois o objeto tem uma identidade pr√≥pria.</p>
</div>
<div class="paragraph">
<p>Um <strong>Objeto de Valor</strong> √© um objeto do modelo de neg√≥cios que n√£o tem identidade pr√≥pria, mas ela √© definida pelos valores definido nela. Os valores n√£o mudam pois eles s√£o a identidade do objeto.</p>
</div>
<div class="paragraph">
<p><em>‚Äî E como podemos correlacionar esses conceitos nos substantivos acima?</em></p>
</div>
<div class="paragraph">
<p>Ora, qual dos substantivos tem uma identidade pr√≥pria apesar dos valores? Vou citar os que acredito ter:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Paciente</strong></p>
</li>
<li>
<p><strong>M√©dico/M√©dica</strong></p>
</li>
<li>
<p><strong>Consulta</strong></p>
</li>
<li>
<p><strong>Exames</strong></p>
</li>
<li>
<p><strong>Prontu√°rio</strong></p>
</li>
<li>
<p><strong>Plano</strong></p>
</li>
<li>
<p><strong>Secret√°rio/Secret√°ria</strong></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><em>‚Äî Tem algum meio f√°cil de identificar esses objetos?</em></p>
</div>
<div class="paragraph">
<p>Tem sim! Tenta imagina o que aconteceria se eu reusasse um objetos desse pra outro valor. Imagina que pegar um <strong>Paciente</strong> e mudar todos os valores para ser outro paciente, o que voc√™ imagina dessa possibilidade? Parece meio improv√°vel porque o paciente √© uma pessoa, ela existe e n√£o d√° pra mudar os valores dele, confere? Exato! Por isso <strong>Paciente</strong> √© uma Entidade.</p>
</div>
<div class="paragraph">
<p>J√° os objetos de valores tem entidade caracterizadas por seus atributos, ent√£o para saber se um objeto de valor podemos fazer uma pergunta. Posso mudar os valores dos atributos? Se a resposta para a primeira pergunta for <strong>n√£o</strong>, temos um objeto de valor que √© imut√°vel. Na verdade todo objeto de valor pode ser considerado imut√°vel, pois n√£o faz sentido alterar um valor dele, apenas o substituir por completo.</p>
</div>
<div class="paragraph">
<p>Do nosso exemplo podemos considerar a <strong>Anamnese</strong> como um objeto de valor. Ela √© o registro das perguntas que o m√©dica fez durante a consulta, mas ela n√£o existe sem a consulta e nem pode ser reutilizada em outra consulta. Do mesmo modo podemos definir <strong>Diagn√≥stico</strong> como um objeto de valor.</p>
</div>
<div class="paragraph">
<p>Existe outros objetos de valores que s√£o inerentes ao nosso modelo mas n√£o est√£o citados porque s√£o t√£o b√°sicos que nem seriam citados em uma lista de requisitos. Vamos pensar em um <strong>Paciente</strong>, o que o paciente tem que √© √∫til para a administra√ß√£o do relacionamento dele com o consult√≥rio? A resposta deve contar <strong>Endere√ßo</strong>, <strong>Contatos</strong>, <strong>Forma de Pagamentos</strong>, etc&#8230;&#8203; A lista vai depender de um levantamento de requisitos real, quem vai modelar esse neg√≥cio precisa conversar, n√£o s√≥ com a m√©dica, mas, PRINCIPALMENTE, com a secret√°ria.</p>
</div>
<div class="paragraph">
<p><em>‚Äî E os outros dois elementos do modelo? Servi√ßo e M√≥dulo?</em></p>
</div>
<div class="paragraph">
<p>Bom, esse deixamos por final propositadamente! Vamos ver como Eric Evans define eles?</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Servi√ßos</div>
Quando um processo significativo ou uma transforma√ß√£o no dom√≠nio n√£o √© responsabilidade natural de uma ENTIDADE ou OBJETO DE VALOR, acrescente uma opera√ß√£o no modelo como uma interface aut√¥noma declara como SERVI√áO. Defina a interface em termos da linguagem do modelo e certifique-se de que o nome da opera√ß√£o fa√ßa parte da LINGUAGEM ONIPRESENTE. Fa√ßa com que o SERVI√áO n√£o tenha um estado.
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">M√≥dulos</div>
Todo mundo utiliza M√ìDULOS, mas poucas pessoas os tratam como partes do modelo j√° completamente desenvolvidas. O c√≥digo √© dividido em v√°rios tipos de categorias, desde aspectos da arquitetura t√©cnica at√© as atribui√ß√µes de trabalho dos desenvolvedores. Mesmo os desenvolvedores que refatoram muito tendem a se contentar com M√ìDULOS concebidos na fase inicial do projeto.
</div>
</div>
<div class="paragraph">
<p>O livro se torna complicado porque n√£o traz defini√ß√µes coesas, mas as defini√ß√µes s√£o trabalhadas na discuss√£o que o capitulo faz. Mas ele quer dizer que <strong>Servi√ßos</strong> s√£o opera√ß√µes que n√£o s√£o responsabilidades de um objeto especifico. E <strong>M√≥dulo</strong> s√£o formas de agrupar o c√≥digo pelo modelo e n√£o pelas caracter√≠sticas arquiteturais.</p>
</div>
<div class="paragraph">
<p>Sobre servi√ßos podemos chegar a primeira conclus√£o que existem opera√ß√µes que DEVEM ser efetuadas pelas Entidades ou Objetos de Valor e existem opera√ß√µes que DEVEM ser efetuadas por Servi√ßos. Como definir quem vai implementar essa opera√ß√£o?</p>
</div>
<div class="paragraph">
<p>√â nessa hora que surge o grande respons√°vel por implementar toda atividade que n√£o tem dono: o MANAGER (ou gerente em tradu√ß√£o livre). Esse na minha opini√£o √© o maior anti-pattern na modelagem de dom√≠nios que existe. Toda vez que definimos uma classe como Manager, estamos criando uma classe sem personalidade e que provavelmente ter√° pouca coes√£o. O correto seria fazer mais perguntas a classe, ou mesmo criar classes mais especificas.</p>
</div>
<div class="paragraph">
<p>Vamos a um exemplo pr√°tico? Quem faz o agendamento das consultas? Se voc√™ pensou em responder quem tem o papel de secret√°ria est√° errado. Essa √© uma fun√ß√£o desse papel, mas ele tamb√©m tem nome e √© mais comum do que imaginamos. Podemos chamar essa classe de <code>AgendadorDeConsultas</code>. Agora coloca ao lado os dois nomes <code>GerenciadorDeConsultas</code> e <code>AgendadorDeConsultas</code>, voc√™ consegue ver o ganho sem√¢ntico que a escolha do papel correto tr√°s? Consegue ver como nomes podem at√© ser mais √≥bvios do que eles podemos imaginar? Porque as respostas s√£o obvias, quem faz o agendamento de consultas √© o agendador, n√£o h√° segredos em dar nomes. E quais opera√ß√µes esse servi√ßo pode fazer? Todas relacionadas ao agendamento de consultas. No caso do n√£o comparecimento a consultas, deve ser outro servi√ßo que vai executar a cobran√ßa da taxa.</p>
</div>
<div class="paragraph">
<p><em>‚Äî E os M√≥dulos?</em></p>
</div>
<div class="paragraph">
<p>Os M√≥dulos s√£o divis√µes l√≥gicas dentro do c√≥digo. Vamos olhar para os nossos requisitos e procurar alguma divis√£o l√≥gica ali? Ser√° que eu conseguiria dividir eles em ao menos 3 m√≥dulos?</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Consulta</p>
<div class="ulist">
<ul>
<li>
<p>"Durante a <strong>consulta</strong> o <strong>m√©dico/m√©dica</strong> far√° a <strong>anamnese</strong> do <strong>paciente</strong>"</p>
</li>
<li>
<p>"A <strong>anamnese</strong> consiste de uma s√©rie de <strong>perguntas</strong> que o <strong>m√©dico/m√©dica</strong> faz para tentar chegar a um <strong>diagn√≥stico</strong>"</p>
</li>
<li>
<p>"A <strong>anamnese</strong> √© usada para avaliar a <strong>evolu√ß√£o</strong> do <strong>paciente</strong>"</p>
</li>
<li>
<p>"O <strong>diagn√≥stico</strong> pode levar v√°rias <strong>consultas</strong> para ser feito"</p>
</li>
<li>
<p>"O <strong>prontu√°rio</strong> de um paciente √© composto de todas as <strong>informa√ß√µes</strong> coletadas"</p>
</li>
<li>
<p>"Um <strong>m√©dico/m√©dica</strong> pode compartilha um <strong>prontu√°rio</strong> de um <strong>paciente</strong>, mas deve escolher quais <strong>informa√ß√µes</strong> v√£o ser compartilhadas"</p>
</li>
<li>
<p>"O <strong>prontu√°rio</strong> √© estritamente sigiloso. Somente o <strong>m√©dico/m√©dica</strong> pode ter acesso e s√≥ pode ser compartilhada para outro <strong>m√©dico/m√©dica</strong> que atende ao mesmo <strong>paciente</strong>."</p>
</li>
<li>
<p>"A <strong>consulta</strong> pode ser marcada pelo <strong>paciente</strong> diretamente pelo site"</p>
</li>
<li>
<p>"O reagendamento de <strong>consulta</strong> pode ser feito pelo <strong>m√©dico/m√©dica</strong> ou <strong>secret√°rio/secret√°ria</strong> e deve ser aprovado pelo <strong>paciente</strong>"</p>
</li>
</ul>
</div>
</li>
<li>
<p>Exame</p>
<div class="ulist">
<ul>
<li>
<p>"O <strong>m√©dico/m√©dica</strong> pode pedir <strong>exames</strong> para chegar a um <strong>diagn√≥stico</strong>"</p>
</li>
</ul>
</div>
</li>
<li>
<p>Cobran√ßa</p>
<div class="ulist">
<ul>
<li>
<p>"Se o <strong>paciente</strong> n√£o comparecer a <strong>consulta</strong>, deve ser cobrada uma <strong>taxa</strong> dele, mesmo que seja por <strong>plano</strong>"</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Eu fiz o exerc√≠cio de separar esses requisitos em 3 m√≥dulos distintos: Consulta, Exame e Cobran√ßa. Essa divis√£o n√£o √© √≥tima e n√£o deveria ser final. Dependendo da evolu√ß√£o das funcionalidades, ou do entendimento do modelo, os m√≥dulos podem ser quebrados ou unidos. Um m√≥dulo deve contar uma unidade dentro do modelo.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="criando-interfaces">Criando Interfaces</h2>
<div class="sectionbody">
<div class="paragraph">
<p>O grande ganho que temos quando dividimos um software em m√≥dulos √© encapsular complexidades. Um m√≥dulo para acessar outro deve acessar uma funcionalidade ou um servi√ßo e n√£o o c√≥digo diretamente.</p>
</div>
<div class="paragraph">
<p>Quando temos todo o c√≥digo sendo implementado no mesmo projeto, processo ou time, temos a tenta√ß√£o de acessar diretamente o c√≥digo de m√≥dulos distintos. Mas esse √© um pecado capital em desenvolvimento de software pois vamos diminuir a coes√£o e aumentar o acoplamento. M√≥dulos diferentes devem ser comunicar atrav√©s de interfaces bem definidas e comuns aos dois contextos.</p>
</div>
<div class="paragraph">
<p><em>‚Äî O que isso significa na pr√°tica?!?!?!</em></p>
</div>
<div class="paragraph">
<p>Devemos olhar os m√≥dulos como caixas pretas e n√£o precisamos de todas as informa√ß√µes contidas em um determinado m√≥dulo, somente a que √© necess√°ria no contexto requerido. Vamos ver isso no contexto das consultas?</p>
</div>
<div class="paragraph">
<p>Para cada <strong>Paciente</strong> existe a informa√ß√£o de qual <strong>Plano</strong> ele possui. Ora um plano de sa√∫de √© importante se uma cobran√ßa √© realizada ou se um exame √© pedido, mas em nada influ√™ncia quando estamos falando da consulta. Ser√° que essa informa√ß√£o √© relevante durante a consulta? Eticamente ela deveria ser omitida. E papel de um m√≥dulo omitir as informa√ß√µes n√£o relevantes aos outros m√≥dulos.</p>
</div>
<div class="paragraph">
<p>Se olharmos agora para o m√≥dulo de Exame, como √© feito o pedido de Exame? Ser√° que os v√°rios laborat√≥rios tem APIs distintas? Ser√° que o formato retornado pelo laborat√≥rio √© √∫nico? Tudo isso n√£o importa para o m√≥dulo de Consulta, a m√©dica na proxima consulta deve ter como informa√ß√£o apenas o resultado dos exames em um formato padronizado.</p>
</div>
<div class="paragraph">
<p>Se a divis√£o de m√≥dulos for respeitada e uma API for utilizada, a divis√£o de m√≥dulos entre processos distintos ser√° feita sem grandes complexidades. Antigamente, em Java, era comum criar interfaces e implementa√ß√µes em objetos pois um servi√ßo pode ser implementado por um servidor distinto e chamado remotamente usando Java RMI. O mesmo ainda pode acontecer hoje quando usamos APIs, ao inv√©s de usarmos o protocolo RMI, que tem uma s√©rie de limita√ß√µes, inclusive isso foi pontuado por Eric Evans ao se referir ao "estado" de um servi√ßo, podemos usar a API como uma interface comum entre cliente e servidor.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="conclusao">Conclus√£o</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Esses quatro elementos da modelagem de software vai possibilitar voc√™ a construir um modelo rico e detalhado. √â sempre bom relembrar que dar o nome correto as coisas √© muito importante e para isso √© importante fazer as perguntas corretas, construindo assim a Linguagem Onipresente que falamos no post anterior.</p>
</div>
</div>
</div>]]></content><author><name>{&quot;twitter&quot;=&gt;&quot;vepo&quot;, &quot;linkedin&quot;=&gt;&quot;https://www.linkedin.com/in/victorosorio/&quot;, &quot;picture&quot;=&gt;&quot;/assets/images/me.avif&quot;}</name></author><category term="DDD" /><category term="Documenta√ß√£o" /><category term="Modelagem de Software" /><summary type="html"><![CDATA[Quais s√£o os elementos b√°sicos de um modelo de software? Existem tipos de elementos que podemos usar para construir qualquer modelo?]]></summary></entry><entry><title type="html">Modelos e Dom√≠nio em Software</title><link href="https://blog.vepo.dev/posts/ddd-01-modelos-e-dominio" rel="alternate" type="text/html" title="Modelos e Dom√≠nio em Software" /><published>2022-09-27T00:00:00+00:00</published><updated>2022-09-27T00:00:00+00:00</updated><id>https://blog.vepo.dev/posts/13-45-00-ddd</id><content type="html" xml:base="https://blog.vepo.dev/posts/ddd-01-modelos-e-dominio"><![CDATA[<div class="paragraph">
<p>Todo software existe para resolver um problema real. N√£o h√° sentido um software existir sem um problema, se isso acontecer, ele ser√° apenas um trecho de c√≥digo que demonstra alguma coisa da linguagem em que foi escrito, mas n√£o ter√° nenhuma utilidade. A computa√ß√£o moderna surgiu como uma ferramenta, pela tentativa de descriptografar mensagens do Eixo, depois foi usada para tratar registros banc√°rios ou processar arquivos de telefonia. Hoje a computa√ß√£o √© usada ubiquamente.</p>
</div>
<div class="sect1">
<h2 id="linguagem-commum-a-computacao">Linguagem Comum a computa√ß√£o</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A linguagem que usamos no dia a dia da computa√ß√£o carrega muito dessa hist√≥ria. Da segunda guerra ainda carregamos muitas das defini√ß√µes que criaram a computa√ß√£o moderna, Turing teve um papel importante tanto na guerra quanto no desenvolvimento da computa√ß√£o. Mas foi o desenvolvimento civil da computa√ß√£o que nos deixou termos como "processamento", "batch" (<em>lote</em> em tradu√ß√£o livre), "transa√ß√µes", "record", etc&#8230;&#8203; Todos esses termos podem parecer apenas termos comuns da computa√ß√£o para voc√™, mas eles vem de outras areas.</p>
</div>
<div class="paragraph">
<p>Para demonstrar isso, vamos olhar para a <a href="https://openjdk.org/jeps/395">JEP 395</a> que definiu Records na linguagem Java. Segundo a JEP, <em>Records</em> s√£o classes que atuam como transportadoras de dados imut√°veis. Mas voc√™ sabe de onde vem o nome record? No primeiro livro de programa√ß√£o que eu li, o <a href="https://www.amazon.com.br/Programming-Language-Brian-W-Kernighan/dp/0131103628?crid=1A3BSP1DGUS6&amp;keywords=brian+kernighan&amp;qid=1664196696&amp;qu=eyJxc2MiOiIyLjU4IiwicXNhIjoiMi42MyIsInFzcCI6IjEuNTAifQ%3D%3D&amp;sprefix=kernig%2Caps%2C674&amp;sr=8-1&amp;ufe=app_do%3Aamzn1.fos.e05b01e0-91a7-477e-a514-15a32325a6d6&amp;linkCode=ll1&amp;tag=vepo0f-20&amp;linkId=5aa1a41b364fcf7183af4ea312f6da63&amp;language=pt_BR&amp;ref_=as_li_ss_tl">C Programming Language</a>, muito se falava de leitura e transforma√ß√£o de arquivos. Da mesma forma, o livro <a href="https://www.amazon.com.br/Programming-Pearls-English-Jon-Bentley-ebook/dp/B01EAW7XXU?crid=21SOLHJO18RTV&amp;keywords=programming+pearls&amp;qid=1664196835&amp;qu=eyJxc2MiOiIxLjcyIiwicXNhIjoiMS4yOSIsInFzcCI6IjAuMDAifQ%3D%3D&amp;sprefix=programmi%2Caps%2C650&amp;sr=8-1&amp;ufe=app_do%3Aamzn1.fos.fcd6d665-32ba-4479-9f21-b774e276a678&amp;linkCode=ll1&amp;tag=vepo0f-20&amp;linkId=ad008d7ae4b16daf4822ad4ce0197288&amp;language=pt_BR&amp;ref_=as_li_ss_tl">Programming Pearls</a>, tr√°s v√°rios desafios de leitura e ordena√ß√£o de registro em arquivos. N√£o √© por acaso que se fala de arquivo e n√£o de comunica√ß√£o de redes, pois nessa √©poca o grande desafio da computa√ß√£o n√£o era interconectar pessoas e computadores, mas processar registros (<em>Records</em>) gerados por outros sistemas.</p>
</div>
<div class="paragraph">
<p>Esses dois livros citados foram escritos nas d√©cadas de 70 e 80, nessa √©poca j√° existia algo chamado <em>Call Detail Records</em> (<strong>Registro de Detalhes da Chamada</strong> em tradu√ß√£o livre), ou CDRs para os mais √≠ntimos. Esses eram registros imut√°veis gerados pelos sistemas de telefonia para posterior processamento, eles s√£o a fonte de verdade quando queremos saber como est√° o uso da rede ou quanto deve ser cobrado de um cliente.</p>
</div>
<div class="paragraph">
<p>Apesar de muito antigos, CDRs ainda existem hoje e s√£o gerados a cada intera√ß√£o do seu celular com a rede de telefonia, ainda existem softwares que processam esses registros e eu trabalho no desenvolvimento de um deles. E at√© hoje Record √© usado como sin√¥nimo de registro imut√°vel. Eu fiz uma busca r√°pida para encontrar a primeira refer√™ncia a CDR na literatura e encontrei e na revista <a href="https://www.computer.org/csdl/magazine/co/1979/06/01658776/13rRUwInv9r">Computer da IEEE de junho 1979</a>, j√° se v√£o 43 anos.</p>
</div>
<div id="cdrs" class="imageblock text-center text-center">
<div class="content">
<img src="/assets/images/CDRs.png" alt="CDRs">
</div>
<div class="title">Figura 1. Trecho da revista Computer da IEEE de 1979 citando CDRs.</div>
</div>
<div class="paragraph">
<p>Outro uso da computa√ß√£o que marcou √©poca foi o famoso software de video locadora. Creio que muitos que me leem s√£o nativos de uma era posterior a esse dinossauro chamado <strong>Video Locadora</strong> e n√£o conseguem nem imaginar o que era a vida sem Netflix e afins. As mais famosas tinham sempre sistemas super simples que se limitavam a um CRUD de Usu√°rio, um CRUD de filme, um sistema de registro de aluguel, busca por filmes e relat√≥rios gerenciais. Eu comecei a ver o surgimento desses softwares por volta do meio dos anos 1990 quando come√ßamos a perguntar se <strong>Exterminador do Futuro 2</strong> estava locado ou n√£o e o atendente ia olhar no computador. Antes disso n√£o existia um meio de responder a essa pergunta que n√£o fosse procurar o filme na prateleira.</p>
</div>
<div class="paragraph">
<p>Muitos desses sistemas eram implementados em Clipper e mantidos pelo nerd cabeludo da cidade, L√° nos long√≠nquos anos 1990 eu conheci algu√©m que fazia a manuten√ß√£o do sistema da video locadora que eu alugava filme e at√© ganhei o livro <a href="https://linguagemclipper.com.br/clipper-summer%C2%B487">Clipper Summer 87</a> que foi meu primeiro contato com programa√ß√£o, apesar de nunca ter escrito uma linha em Clipper.</p>
</div>
<div class="paragraph">
<p>Esses sistemas antigos criaram uma linguagem comum para a computa√ß√£o e essa linguagem, que usamos at√© hoje, que cont√©m termos que s√≥ s√£o entendidos por quem √© da √°rea. Quer ver? Vamos supor que eu esteja criando um sistema m√©dico e precise reportar o que estou fazendo no momento, se eu disser que <em>"estou finalizando o CRUD de Anamnese mas estou com problemas para salvar a entidade no Postgres"</em>. Um m√©dico n√£o vai entender absolutamente nada porque ele n√£o sabe o que √© CRUD, nem entidade e muito menos Postgres. Tudo que ele vai entender √© que a atividade √© relacionada a Anamnese, sua principal atividade em uma consulta m√©dica.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="linguagem-ubiqua">Linguagem Ub√≠qua</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Ao modelar um sistema, o primeiro passo que precisamos fazer √© capturar termos. Todo sistema j√° tem um dom√≠nio e uma linguagem pr√≥pria (n√£o estou falando de linguagem de programa√ß√£o), ela precisa ser mapeada, definida e compreendida por todos os times envolvidos no desenvolvimento do produto, que em muitos casos podem ter pessoas que n√£o s√£o desenvolvedoras. Essa linguagem n√£o √© criada, ela existe, mas precisa ser definida. Cada software tem um dom√≠nio especifico e ele ainda pode ser composto de outros subdom√≠nios que vem ou das tecnologias escolhidas ou dos pontos de contato que o software possui.</p>
</div>
<div class="paragraph">
<p><em>‚Äî Mas o que √© <strong>dom√≠nio</strong>?!?!?</em></p>
</div>
<div class="paragraph">
<p>Bom, <strong>dom√≠nio</strong> √© a √°rea de interesse que o software busca mapear. Vamos voltar ao exemplo do software para consulta m√©dica para tentar entender melhor. Ele dever√° ser focado na <strong>Anamnese</strong> do <strong>Paciente</strong> realizada pelo <strong>M√©dico</strong>, mas tamb√©m ser√° respons√°vel por realizar agendamentos de <strong>Consultas</strong> e <strong>Retornos</strong> e receber <strong>Resultados de Exames</strong>. Somente na senten√ßa anterior podemos encontrar alguns termos que ser√£o comuns a todo o dom√≠nio de um software de atendimento m√©dico, mas que n√£o fazem nenhum sentido fora dele. Faz todo sentido diferenciar o usu√°rio que tem a fun√ß√£o M√©dica, do usu√°rio que tem a fun√ß√£o Secret√°ria e o Paciente, mas em outros sistemas s√≥ existem Usu√°rio. Esses termos e as suas defini√ß√µes devem ser usados para se construir o modelo do software, tanto de dados como dos sistemas.</p>
</div>
<div class="paragraph">
<p>Para ser enf√°tico, o modelo √© o cora√ß√£o do design de software e ele deve gerar uma linguagem que deve ser usada por todos os times envolvidos no desenvolvimento para se comunicarem entre si. O modelo √© o conhecimento do dom√≠nio destilado e organizado com o intuito de todos terem uma melhor compreens√£o do que est√° sendo desenvolvido. Eric Evans, em seu livro <a href="https://www.amazon.com.br/Domain-Driven-Design-Eric-Evans/dp/8550800651?__mk_pt_BR=%C3%85M%C3%85%C5%BD%C3%95%C3%91&amp;crid=1ZIEQ6223BW12&amp;dchild=1&amp;keywords=domain+driven+design&amp;qid=1595274795&amp;s=books&amp;sprefix=domai%2Caps%2C293&amp;sr=1-1&amp;linkCode=ll1&amp;tag=vepo0f-20&amp;linkId=3dc19604b1199d2af32211ccd49eb11f&amp;language=pt_BR&amp;ref_=as_li_ss_tl">Domain Driven Design</a>, descreve essa linguagem como Linguagem Onipresente, ou Linguagem Ub√≠qua, pois ela deve estar presente em todas as intera√ß√µes do desenvolvimento, mas ela existe s√≥ para o contexto do software em quest√£o. (<em>Ali√°s, grande parte desse texto √© composto por cita√ß√µes do livro de Evans.</em>)</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="codigo-conceito-linguagem">C√≥digo, Conceitos e Linguagem</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Quando vamos escrever software temos que colocar no c√≥digo as regras neg√≥cio, mas um erro comum que fazemos √© escrever o c√≥digo como um elemento a parte do neg√≥cio. Em muitos casos o desenvolvedor pensa em termos computacionais e esquecem que o software tem que mapear um dom√≠nio, inclusive usando a nomenclatura da linguagem onipresente. A atividade de modelar um software consiste na atividade de capturar um modelo, identificar substantivos, verbos, rela√ß√µes e transformar esse modelo em c√≥digo.</p>
</div>
<div class="paragraph">
<p>Para que essa atividade de modelagem seja bem feita √© preciso treinar algumas habilidades, que n√£o s√£o t√©cnicas, como leitura e aten√ß√£o. N√£o podemos s√≥ pensar em termos computacionais, precisamos pensar no dom√≠nio, no neg√≥cio, e na rela√ß√£o do neg√≥cio com o c√≥digo. Devemos aprender a ler o dom√≠nio e fazer perguntas certas para conseguir modelar o que est√° acontecendo. Um c√≥digo ser√° expressivo se ele reflete o modelo, para isso √© preciso.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Ligar o modelo a implementa√ß√£o</strong>: A implementa√ß√£o deve usar os mesmo termos e verbos do modelo</p>
</li>
<li>
<p><strong>Cultivar uma linguagem baseada no modelo</strong>: Toda a comunica√ß√£o nas equipes deve usar os termos do modelo.</p>
</li>
<li>
<p><strong>Desenvolver um modelo rico em conhecimento</strong>: O modelo n√£o cont√©m s√≥ substantivos, mas verbos e rela√ß√µes. Isso pode ser expresso atrav√©s de senten√ßas como "O M√©dico √© respons√°vel por fazer a Anamnese" ou "O Laborat√≥rio envia o Exame atrav√©s de uma API" ou "O Paciente pode acessar os resultados do Exame, mas n√£o pode acessar a Anamnese".</p>
</li>
<li>
<p><strong>Destilar o modelo</strong>: O modelo ir√° obrigatoriamente evoluindo com o software. Novos conceitos e rela√ß√µes s√£o adicionadas durante o desenvolvimento.</p>
</li>
<li>
<p><strong>Colher e experimentar ideias</strong>: Com o modelo, novas ideas podem ser validadas usando a linguagem onipresente. Seriam as ideias v√°lidas ou elas n√£o podem ser usadas. Por exemplo, eu n√£o sei se √© √©tico um m√©dico expor a Anamnese dele ao paciente, mas sei que √© completamente anti-√©tico expor a terceiros. Mas quando dois m√©dicos de especialidades diferentes acompanham o mesmo paciente, eles normalmente compartilham certas informa√ß√µes. As valida√ß√µes de ideias relacionadas a esse dom√≠nio s√≥ poder√£o ser feitas se existir uma linguagem onipresente bem trabalhada.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><em>‚Äî Cara, voc√™ t√° sendo muito subjetivo. Vamos ser mais pr√°tico!</em></p>
</div>
<div class="paragraph">
<p>Ent√£o vamos l√°. Em muitas discuss√µes no Twitter vamos pessoal discutindo sobre <a href="https://martinfowler.com/eaaCatalog/dataTransferObject.html">DTO</a> (<em>Data Transfer Object</em> ou Objeto de Transfer√™ncia de Dados em tradu√ß√£o livre). O objetivo de se ter um DTO √© ser capaz de serializar e deserializar objetos em sistemas distintos facilmente, s√£o objetos sem l√≥gica de neg√≥cio e completamente focados no dado a ser transferido, ou seja, fazem parte da <strong>API p√∫blica</strong>. Na defini√ß√£o anterior eu fiz um grifo proposital em API p√∫blica porque na grande maioria dos casos usamos o nome DTO como parte do modelo, como se ele fosse parte do vocabul√°rio do dom√≠nio.</p>
</div>
<div class="paragraph">
<p>Se voltarmos ao nosso sistema de consultas m√©dicas, √© capaz que algu√©m comece a modela um <code>AnamneseDTO</code>, o que na minha opini√£o √© errado e eu posso provar.</p>
</div>
<div class="paragraph">
<p><em>‚Äî COMO ASSIM!!! ERRADO!?!?!?! Todo mundo faz isso!</em></p>
</div>
<div class="paragraph">
<p>Sim e muitas das regras de neg√≥cio n√£o podem ser modeladas facilmente tornando o c√≥digo dif√≠cil de ser compreendido. Al√©m de deixar a documenta√ß√£o mais pobre. Vamos pensar nos DTOs da Anamnese, para que eu vou usar ele? Eu posso pensar em tr√™s condi√ß√µes obvias: &#169;riar, (E)ditar e (L)er. S√≥ ficou faltando o D do CRUD porque normalmente n√£o precisa de um DTO para ele. Nessas opera√ß√µes, se estivermos falando de uma API REST, sempre teremos os DTOs de Request e Response. LOGO, porque n√£o termos os DTOs: <code>CriarAnamneseRequest</code>, <code>CriarAnamneseResponse</code>, <code>AtualizarAnamneseRequest</code>, <code>AtualizarAnamneseResponse</code>, <code>LerAnamneseResponse</code>. Usar essa nomenclatura agrega valor ao nosso c√≥digo ao contr√°rio de usar somente DTO, que √© um termo que deveria ficar restrito aos livros de modelagem de software visto que √© um tipo de objeto e n√£o o nome que se deve usar para o objeto. Ao meu ver, √© como se eu desse um nome a um cachorro de Cachorro. (<em>Ali√°s, meu filho de 4 anos faz isso quando pedimos para ele escolher um nome para algum boneco que ele ganha. Esses dias ele ganhou um polvo que se chama Polvo</em>)</p>
</div>
<div class="paragraph">
<p><em>‚Äî Mas, usar Request e Response no nome?! Eu nunca vi isso!</em></p>
</div>
<div class="paragraph">
<p>Talvez n√≥s n√£o vemos isso sendo comumente usado porque pouco se fala de modelagem de software back-end. Muito se debate de modelagem front-end e se tem at√© modelos pre-implementados nos frameworks da moda, mas √© comum usar memes mostrando o back-end como um monstro. Eu recomendo voc√™ procurar em APIs p√∫blicas para ver como √© feito. Se interessar a API do 5G √© p√∫blica e foi modelada por um cons√≥rcio, olha como √© o servi√ßo de <a href="https://jdegre.github.io/editor/?url=https://raw.githubusercontent.com/jdegre/5GC_APIs/master/TS32291_Nchf_ConvergedCharging.yaml">Nchf_ConvergedCharging</a> (<em>basicamente o servi√ßo que controla a cobran√ßa do seu celular</em>).</p>
</div>
<div class="paragraph">
<p>Usando essa forma de nomenclatura voc√™ consegue trazer mais intencionalidade ao seu c√≥digo, assim como a sua API e consegue facilitar a valida√ß√£o das requisi√ß√µes pela API. Vamos supor que ao criar uma Anamnese todos os campos sejam obrigat√≥rios, mas para se editar nenhum campo seja obrigat√≥rio, se voc√™ usa Jakarta EE com <a href="https://blog.vepo.dev/posts/using-bean-Validation-on-quarkus">Bean Validation</a>, voc√™ pode fazer isso facilmente usando algumas anota√ß√µes nos DTOs e a anota√ß√£o <code>@Valid</code> no m√©todo exposto pela API. Se usarmos classes diferentes, vamos poder criar anota√ß√µes diferentes.</p>
</div>
<div class="paragraph">
<p><em>‚Äî Ahhhh&#8230;&#8203; MAS A√ç EU TENHO C√ìDIGO DUPLICADO!!!!</em></p>
</div>
<div class="paragraph">
<p>Sim e n√£o. C√≥digo duplicado √© ruim quando ele n√£o √© √≥bvio e quando ele define comportamento. Quando estamos falando de modelagem de dados, o c√≥digo duplicado √© bem vindo pois estamos representando uma entidade do mundo real. Ent√£o vai com calma e pode duplicar c√≥digo sim pois cada classe representa um objeto e uma opera√ß√£o distinta. Fica atento somente se ao usar uma classe abstrata a gera√ß√£o da documenta√ß√£o OpenAPI vai ficar interessante, pois essas classes tamb√©m podem gerar uma documenta√ß√£o viva que pode ser at√© distribu√≠da se voc√™ usar o <a href="https://microprofile.io/project/eclipse/microprofile-open-api">MicroProfile.io OpenAPI</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_modelos-diagramas-e-documenta√ß√£o">Modelos, Diagramas e Documenta√ß√£o</h2>
<div class="sectionbody">
<div class="paragraph">
<p>J√° discutimos como a linguagem influi no c√≥digo, mas ela tem alguma import√¢ncia para os diagramas que normalmente constru√≠mos?</p>
</div>
<div class="paragraph">
<p>A fun√ß√£o de um diagrama √© representar uma arquitetura, e em muitos casos constru√≠mos diagramas que n√£o tem nenhuma signific√¢ncia. Por exemplo, se eu colocar dois servidores conversando por HTTP, eles podem representar a gigantesca maioria dos software em produ√ß√µes hoje em dia. Podem ser que seja um Blog ou um Sistema de Gerenciamento de Linhas de √înibus. Um diagrama s√≥ tem signific√¢ncia se √© acompanhado por um modelo e isso implica um dom√≠nio e uma linguagem.</p>
</div>
<div class="paragraph">
<p>Vamos supor que no CRUD de Anamnese que estamos desenvolvendo, a Anamnese s√≥ possa ser visualizada quando digitada uma senha. Todo o conte√∫do dela √© criptografada para que, mesmo que haja um vazamento de dados, a informa√ß√£o seja mantida em sigilo. A forma como descrevemos essa atividade tem que ser acompanhada de conceitos porque ela pode parecer com outras atividades, mas existe um requisito especifico e s√≥ acess√≠vel ao neg√≥cio.</p>
</div>
<div class="paragraph">
<p>Um diagrama representa uma pequena parte do modelo e nunca pode ser compreendido sem o seu contexto. Ele servir√° para capturar informa√ß√µes sobre comportamento, mas nunca defini√ß√µes de conceitos ou substantivos. Conceitos e substantivos devem ser expressos atrav√©s de uma documenta√ß√£o textual (WIKI ou Markdown). Um documento n√£o deve fazer aquilo que o c√≥digo j√° faz, ela deve conter conceitos que s√£o ortogonais ao c√≥digo. Por exemplo, falamos que √© anti-√©tico que algu√©m que n√£o seja o m√©dico de um paciente ver a Anamnese dele, essa informa√ß√£o deve estar em uma documenta√ß√£o externa ao c√≥digo. O c√≥digo s√≥ ir√° implementar a l√≥gica de visualiza√ß√£o da Anamnese (observe como eu posso usar a palavra e ela tem signific√¢ncia), mas a documenta√ß√£o pode trazer refer√™ncias, implica√ß√µes √©ticas e legais. Essa √© uma informa√ß√£o que deve estar documentada textualmente. J√° o diagrama vai usar a linguagem desenvolvida para contextualizar o comportamento com os componentes.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_como-escreve-a-documenta√ß√£o">Como escreve a documenta√ß√£o</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Agora para finalizar temos que desmistificar a documenta√ß√£o. Sendo sincero √© muito dif√≠cil encontrar um desenvolvedor que goste de documentar. N√£o se sinta culpado por ter dificuldades, pois √© realmente dif√≠cil se expressar em Portugu√™s, as vezes preferimos em c√≥digo. Mas temos que lembrar que toda atividade √© um treino e escrever uma boa documenta√ß√£o √© uma habilidade que tamb√©m pode ser desenvolvida.</p>
</div>
<div class="paragraph">
<p>Quando eu comecei a colocar meus pensamos em forma de texto, eu tinha uma dificuldade enorme para elaborar as frases. Isso porque o pensamento n√£o √© linear como as linhas de um caderno, ou no caso, as linhas de um editor de texto (<em>VS Code</em> no caso). Foram com os anos de blog e depois com a escrita de livros (<em>confere l√° na <a href="https://www.casadocodigo.com.br/products/livro-roadmap-backend">Casa do C√≥digo</a></em>) que eu comecei a ganhar habilidades de escrever uma boa documenta√ß√£o. Quem trabalha em grandes corpora√ß√µes deve ser habituado a escrever e-mails&#8230;&#8203; √â quase parecido, mas tem outro objetivo. Eu escrevi sobre o que eu acho que uma boa documenta√ß√£o tem em <a href="https://blog.vepo.dev/posts/inicie-um-projeto-pelo-readme"><em>Inicie um projeto pelo README.md</em></a>.</p>
</div>
<div class="paragraph">
<p>Se voc√™ leu o post citado, vai perceber que eu defendo que um projeto deve ser come√ßado pelo arquivo README.md. Eu escrevi isso antes de conhecer o livro <a href="https://www.amazon.com.br/Domain-Driven-Design-Eric-Evans/dp/8550800651?crid=30GBZ1Z0JMLTU&amp;keywords=domain+driven+design&amp;qid=1664294472&amp;qu=eyJxc2MiOiIyLjYzIiwicXNhIjoiMS43OSIsInFzcCI6IjEuODMifQ%3D%3D&amp;sprefix=domain%2Caps%2C1017&amp;sr=8-1&amp;linkCode=ll1&amp;tag=vepo0f-20&amp;linkId=0a0ce38de23f9a56a15c0229763a7688&amp;language=pt_BR&amp;ref_=as_li_ss_tl">Domain-Driven Design: Atacando as complexidades no cora√ß√£o do software</a>, mas eu continua acreditando que essa abordagem ainda √© essencial, mas com uma pequena diferen√ßa. Quando falamos de DDD, ou modelagem de dom√≠nio, estamos falando de softwares completos e n√£o apenas um projeto. Para contextualizar, esse post acima foi escrito quando eu estava implementando um framework em uma empresa anterior e precisei me preparar para documentar ele de forma que pudesse tanto ser usado para desenvolvimento de funcionalidades para o cliente quanto para manuten√ß√£o. Logo o enfoque o post √© um framework em que o dom√≠nio √© o pr√≥prio trabalho de desenvolver software. Voc√™ vai perceber que quando estamos falando de frameworks, bibliotecas e plataformas o foco da documenta√ß√£o √© a atividade de desenvolvimento, pois esse √© o dom√≠nio desse software.</p>
</div>
<div class="paragraph">
<p>Mas, como j√° falamos, modelagem de software √© onipresente hoje em dia. Podemos escrever software para usu√°rios que nunca se imaginaram desenvolvendo software. Voc√™ imagina que quem trabalha com medicina tem algum intuito de escrever algum c√≥digo algum dia? Pode at√© escrever, mas ser√° uma exce√ß√£o.</p>
</div>
<div class="paragraph">
<p>Mas voltando a documenta√ß√£o, primeiro √© se definir que tipo de documenta√ß√£o precisamos fazer e quem √© o p√∫blico alvo dessa documenta√ß√£o. Se for o desenvolvedor do projeto, ela pode ser escrita o mais pr√≥ximo do c√≥digo poss√≠vel e isso implica que √© poss√≠vel se usar Markdown ou <a href="https://docs.asciidoctor.org/asciidoc/latest/syntax-quick-reference/">AsciiDoc</a>. Eu recomendaria o uso do AsciiDoc porque com esse formato podemos gerar tanto p√°ginas simples, documenta√ß√µes robustas ou, quem sabe, at√© um livro. Se o p√∫blico for mais amplo, inclu√≠do desenvolvedores de outros projetos ou pessoas de neg√≥cio, √© prefer√≠vel que se use uma wiki. O importante ao se usar uma wiki √© definir um padr√£o para que o conhecimento n√£o se perca.</p>
</div>
<div class="paragraph">
<p>N√£o importando qual s√£o nossas escolhas, o importante √© tratar a documenta√ß√£o como um entreg√°vel, como ela realmente √©. Documenta√ß√£o √© parte de um projeto e ela vai detalhar o que o nosso software faz. A aus√™ncia de documenta√ß√£o pode resultar em retrabalho ou implementa√ß√µes incorretas.</p>
</div>
</div>
</div>]]></content><author><name>{&quot;twitter&quot;=&gt;&quot;vepo&quot;, &quot;linkedin&quot;=&gt;&quot;https://www.linkedin.com/in/victorosorio/&quot;, &quot;picture&quot;=&gt;&quot;/assets/images/me.avif&quot;}</name></author><category term="DDD" /><category term="Documenta√ß√£o" /><category term="Modelagem de Software" /><summary type="html"><![CDATA[Todo software existe para resolver um problema real. E para resolver esse problema precisa ser bem modelado. Nesse post vou navegar um pouco pela introdu√ß√£o do livro Domain-Driven Design para explicar o que √© modelo e o que √© dom√≠nio e como podemos modelar nosso software.]]></summary></entry><entry><title type="html">Linguagem Onipresente</title><link href="https://blog.vepo.dev/posts/linguagem-onipresente" rel="alternate" type="text/html" title="Linguagem Onipresente" /><published>2020-07-20T00:00:00+00:00</published><updated>2020-07-20T00:00:00+00:00</updated><id>https://blog.vepo.dev/posts/15-15-12-linguagem-onipresente</id><content type="html" xml:base="https://blog.vepo.dev/posts/linguagem-onipresente"><![CDATA[<p>Faz alguns meses comprei o livro ‚ÄúDomain-Driven Desing: Atacando as Complexidades no Cora√ß√£o do Software‚Äù e comecei a ler somente agora. Ao iniciar a leitura j√° topo com um termo muito interessante e bem pertinente. O autor nos apresenta a necessidade de se construir uma Linguagem Onipresente (<em>ubiquitous language</em>).</p>

<p>Nesse post vou apresentar o que √© uma Linguagem Onipresente e como podemos contrui-l√°. Fica uma aviso que eu ainda estou come√ßando a ler o livro. üòâ</p>

<h1 id="porque-desenvolver-programas">Porque desenvolver programas?</h1>

<p>Antes de entrar na faculdade, gostava muito de matem√°tica e achava ela em si um fim. Pra mim, a matem√°tica existia simplesmente por existir. Foi grande a minha decep√ß√£o quando descobri que a matem√°tica √© uma linguagem com um proposito. Calculo existe para explicar o movimentos dos Corpos e foi criada por Newton. Se Newton n√£o tivesse interesse de estudar o movimento dos corpos, provavelmente o Calculo n√£o existiria e o mundo seria completamente diferente.</p>

<p>Porque eu fui falar de matem√°tica? Porque com computa√ß√£o acontece a mesma coisa. A computa√ß√£o em si n√£o existiria se ela n√£o ajudasse a resolver problemas do mundo real. Pra que programar? No fundo voc√™ est√° resolvendo um problema ou automatizando uma atividade que j√° estava a√≠. Logo existe um usu√°rio que est√° a√≠ j√° lidando com o problema que voc√™ quer resolver. Este pode ser um operador de caixa, um advogado, uma m√©dica, uma farmac√™utica, um chefe de cozinha ou voc√™ desenvolvendo software.</p>

<p>Esse usu√°rio j√° lida com o problema pelo qual voc√™ vai resolver e j√° tem muitos conceitos criados. Chamamos de <strong>Dom√≠nio</strong> (<em>Domain</em>) a √Årea de Atua√ß√£o desse problema.</p>

<h1 id="a-necessidade-de-modelos">A Necessidade de Modelos</h1>

<p>Qualquer desenvolvedor sabe que precisa de Modelos. Os mais inexperientes n√£o conseguem abstrair o que √© um modelo, ficando presos a conceitos da linguagem.</p>

<p><em>‚Äî  ‚ÄúEu tenho um array aqui com o nome dos meus funcion√°rios‚Äù</em></p>

<p>A cria√ß√£o de um modelo √© um passo importante para se resolver o problema satisfatoriamente. No caso da frase acima, eu considero que existe a entidade <strong>Funcion√°rio</strong>. Este passa a ser um conceito abstrato no contexto do seu projeto. A <strong>Funcion√°rio</strong> ser√£o dados atribui√ß√µes relacionamentos.</p>

<p><em>‚Äî  ‚ÄúTenho 500 <strong>Funcion√°rios</strong> na Base de Dados, e consigo fazer um relat√≥rio por departamento.‚Äù</em></p>

<p>Modelos podem ser representados em diagramas, gr√°ficos e textos. Por√©m eles existem no c√≥digo, est√£o amarrados ao c√≥digo. Uma vez mudando o c√≥digo o diagrama n√£o √© atualizado, o que pode gerar confus√£o.</p>

<h1 id="de-modelos-a-dom√≠nio">De Modelos a Dom√≠nio</h1>

<p>Como j√° foi dito, Dom√≠nio √© algo que j√° existe antes da cria√ß√£o de um software. Antes que voc√™ escreva um programa para o RH da empresa, j√° existir√£o funcion√°rios l√°. Ao contr√°rio de Modelos, o Dom√≠nio ele √© inerente ao neg√≥cio. Este pode n√£o estar mapeado, ou nomeado, mas j√° existe l√°.</p>

<p>Podemos afirmar que o conhecimento do Dom√≠nio, ou o Modelo do Dom√≠nio √© o cora√ß√£o do software. Sem o conhecimento dela, o software pode desempenhar um papel n√£o desejado e assim n√£o ser utilizado.</p>

<p>Vale aqui resaltar que Modelo pode se aplicado em v√°rios contextos. Podemos falar em Modelo de Dados ou Modelo de Dom√≠nio. Aqui vamos tratar de Modelo de Dom√≠nio.</p>

<p><img src="https://dev-to-uploads.s3.amazonaws.com/i/88dcrwupiimcho95whsm.png" alt="Vai um vinho?" /></p>

<h1 id="construindo-o-modelo-do-dom√≠nio">Construindo o Modelo do Dom√≠nio</h1>

<p>O Dom√≠nio √© algo prexistente, por√©m cada usu√°rio tem uma vis√£o do mesmo. Um cliente do supermercado n√£o precisa saber o hor√°rio de entrega do fornecedor de verduras, por√©m o estoquista precisa dessa informa√ß√£o. Por√©m, mesmo j√° existindo, pode ser que este n√£o esteja mapeado ou modelado.</p>

<p>A atividade de se Modelar um Dom√≠nio √© um processo em v√°rias etapas. Ela involve questionamos e perguntas e deve ser feita em voz alta.</p>

<p><em>‚Äî  ‚ÄúUm <strong>Funcion√°rio</strong> tem apenas um supervisor?‚Äù</em>
<em>‚Äî  ‚ÄúN√£o, h√° <strong>Funcion√°rios</strong> que respondem para seu gerente e para o cliente.</em>
<em>‚Äî  ‚ÄúE quais s√£o as responsabilidades do <strong>Gerente</strong> para com o <strong>Funcion√°rio</strong>? E quando esse responde tamb√©m ao <strong>Cliente</strong>, qual o papel do mesmo?</em></p>

<p>Observe que no dialogo acima, h√° palavras que aparecem em negrito. Quando coloco elas em negrito, estou afirmando que a mesma foi incorporada ao Modelo de Dom√≠nio. Assim nesse pegqueno dialogo, o desenvolvedor acabou de descobrir que na modelagem de um software para RH, deve levar em considera√ß√£o tanto o <strong>Gerente</strong> do <strong>Funcion√°rio</strong> quanto o <strong>Cliente</strong>, por√©m o <strong>Cliente</strong> n√£o √© um <strong>Funcion√°rio</strong>.</p>

<p>Esses termos quando identificados e devidamente adicionados ao Modelo, come√ßam a fazer parte da <strong>Linguagem Onipresente</strong> do mesmo. <strong>Linguagem Onipresente</strong> √© o conjunto de nomes de entidades e opera√ß√µes que a mesma podem fazer associadas ao Dom√≠nio do Software. Essa linguagem deve ser construida e cultivada em todo o ciclo de vida do projeto de software, n√£o sendo considerada acabada enquanto o software ainda estiver em desenvolvimento.</p>

<h2 id="como-extrair-o-modelo">Como extrair o Modelo</h2>

<h3 id="1-ligando-o-modelo-e-a-implementa√ß√£o">1. Ligando o modelo e a implementa√ß√£o</h3>

<p>O modelo do Dom√≠nio √© o cora√ß√£o do software e ele deve refletir em todos os os contextos, por isso se chama Onipresente. Assim ele deve estar presente no C√≥digo, na Base de Dados, na Documenta√ß√£o e na comunica√ß√£o de todos envolvidos no projeto. Tanto os desenvolvedores quandos os usu√°rios do programa.</p>

<p>Se, por algum motivo, o modelo n√£o estiver atualizado em algum desses contextos, teremos um problema em potencial.</p>

<h3 id="2-cultivando-uma-linguagem-baseada-no-modelo">2. Cultivando uma Linguagem baseada no Modelo</h3>

<p>Extrair termos do Dom√≠nio e come√ßar a usa-los corretamente no dia a dia √© um h√°bito muito √∫til no desenvolvimento de software. Ele habilitar√° os usu√°rios a terem ci√™ncia de certas atividades que j√° desenvolvem. E tamb√©m ajudar√° os desenvolvedores a conhecerem as atividades que o usu√°rio desenvolvem.</p>

<p>O desenvolvedor n√£o precisa saber exatamente como a atividade √© desenvolvida, assim como o usu√°rio n√£o precisa saber de detalhes da implementa√ß√£o. Mas habilitar√° uma comunica√ß√£o com os dois ‚Äú<em>extremos</em>‚Äù.</p>

<h3 id="3-desenvolvendo-um-modelo-rico-em-conhecimentos">3. Desenvolvendo um modelo rico em conhecimentos</h3>

<p>O modelo vai muito al√©m do que est√° implementado. E ele pode ser enriquecido sempre que poss√≠vel. Construir o modelo √© uma atividade que n√£o tem fim.</p>

<h3 id="4-destilando-o-modelo">4. Destilando o modelo</h3>

<p>Apesar de a constru√ß√£o do modelo n√£o acabar, enquanto o projeto n√£o acabar. N√£o significa que ele n√£o possa ser simplificado. Sou muito f√£ do princ√≠pio <a href="https://pt.wikipedia.org/wiki/Princ%C3%ADpio_KISS"><em><strong>KISS</strong>: Keep It Simple, Stupid</em></a>.</p>

<p>Em qualquer estudo, ao se adicionar novas informa√ß√µes aumenta-se a complexidade do sistemas. <a href="https://pt.wikipedia.org/wiki/Leis_de_Newton#Primeira_lei_de_Newton">Isso √© uma lei da natureza, se n√£o gastarmos esfor√ßo para compreender a rela√ß√£o entre os novos conceitos e os antigos tentando simplificar</a>‚Ä¶ <a href="https://www.significados.com.br/entropia/">a entropia do sistema vai aumentar</a>.</p>

<h3 id="5-colhendo-ideias-e-experimentando">5. Colhendo ideias e experimentando</h3>

<p>A constru√ß√£o de inte√ß√µes, cen√°rios, pressupostos e afirma√ß√µes √© um exercicio que enriquece muito o modelo. Simples perguntas podem criar novas entidades, podem fundir duas entidades que poderiam ser consideradas distintas ou simplesmente alterar rela√ß√µes entre entidades. Nesse ponto n√£o h√° pergunta boba.</p>

<h2 id="como-n√£o-extrair-o-modelo">Como <strong>N√ÉO</strong> extrair o Modelo</h2>

<h3 id="1-importar-modelos">1. Importar modelos</h3>

<p>√â comum, em projetos de software, a importa√ß√£o de modelos j√° prontos. Ao se iniciar um projeto j√° se define algumas classes e objetos com nomes padr√£o. Quem nunca viu <strong>UserService</strong>? Pra que serve um UserService? Essa pergunta pode ter uma resposta completamente gen√©rica que em muitos casos n√£o se aplica ao atual projeto.</p>

<h3 id="2-importar-uma-nomenclatura">2. Importar uma nomenclatura</h3>

<p>√â comum, em projetos de software, nomear objetos com o nome dos seus tipos. Muitas vezes o desenvolvedor cria um <strong>UserDTO</strong> logo ao se iniciar um projeto, sem ao menos se perguntar qual seria a melhor nomenclatura.</p>

<p><a href="https://pt.wikipedia.org/wiki/Objeto_de_Transfer%C3%AAncia_de_Dados">DTO</a> significa <strong>Data Transfer Object</strong> e √© um objeto usado para transf√™rencia de Dados. Eu uso muitos DTOs, mas nunca uso esse sufixo, at√© porque ele n√£o tem sentido dentro de um software. Quando os uso posso chamar:</p>

<table>
  <thead>
    <tr>
      <th>Nome</th>
      <th>Descri√ß√£o</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>UserResponse</strong></td>
      <td>Resposta a chamada REST que retorna os dados do Usu√°rio</td>
    </tr>
    <tr>
      <td><strong>UserCreatedEvent</strong></td>
      <td>Evento de cria√ß√£o de um Usu√°rio</td>
    </tr>
    <tr>
      <td><strong>UserChangedEvent</strong></td>
      <td>Evento de altera√ß√£o dos dados de um usu√°rio</td>
    </tr>
    <tr>
      <td><strong>UserPayload</strong></td>
      <td>Dados do Usu√°rio usado para cria√ß√£o em servi√ßos REST</td>
    </tr>
    <tr>
      <td>‚Ä¶</td>
      <td>‚Ä¶</td>
    </tr>
  </tbody>
</table>

<p>Observe que para cada Nome existe uma funcionalidade associada.</p>

<h3 id="3-desenvolvimento-orientado-a-design-patterns">3. Desenvolvimento Orientado a Design Patterns</h3>

<p>Design Patterns s√£o extremamente uteis, por√©m devem n√£o devem ser usados apenas por usar. Eles devem fazer sentido. Pode se usar uma adapta√ß√£o ou mesmo uma mescla de dois sentidos, vai depender do problema. Entre um Desing Pattern e o Dom√≠nio, prefira o Dom√≠nio. N√£o que ele tenha que existir um conflito entre os dois, mas o Pattern tem que se adaptar ao modelo.</p>

<h1 id="conclus√£o">Conclus√£o</h1>

<p>Modela um software √© uma atividade muito importante. Cada software tem o seu Dom√≠nio e este deve ser modela de acordo com o problema a ser resolvido. O Dom√≠nio √© muito mais extenso que a implementa√ß√£o do software e quando desenvolvedores limitam sua linguagem a apenas a implementa√ß√£o isso pode ser um fator gerador de problemas.</p>

<h1 id="livros-recomendados">Livros Recomendados</h1>

<ol>
  <li><a href="https://www.amazon.com.br/Domain-Driven-Design-Eric-Evans/dp/8550800651?__mk_pt_BR=%C3%85M%C3%85%C5%BD%C3%95%C3%91&amp;crid=1ZIEQ6223BW12&amp;dchild=1&amp;keywords=domain+driven+design&amp;qid=1595274795&amp;s=books&amp;sprefix=domai%2Caps%2C293&amp;sr=1-1&amp;linkCode=ll1&amp;tag=vepo0f-20&amp;linkId=8f0de1abfc56f235286a41828f4019fc&amp;language=pt_BR&amp;ref_=as_li_ss_tl">Domain-Driven Design: Atacando as Complexidades no Cora√ß√£o do Software</a> de Eric Evans</li>
  <li><a href="https://www.amazon.com.br/Como-Ser-Um-Programador-Melhor/dp/8575224158?__mk_pt_BR=%C3%85M%C3%85%C5%BD%C3%95%C3%91&amp;crid=2WIBH8YTQLN6C&amp;dchild=1&amp;keywords=como+ser+um+programador+melhor&amp;qid=1595274941&amp;s=books&amp;sprefix=como+ser+um%2Cstripbooks%2C287&amp;sr=1-1&amp;linkCode=ll1&amp;tag=vepo0f-20&amp;linkId=98a599ceadf5e966cf2675305e638090&amp;language=pt_BR&amp;ref_=as_li_ss_tl">Como ser um Programador Melhor: um Manual Para Programadores que se Importam com C√≥digo</a> de Pete Goodliffe</li>
  <li><a href="https://www.amazon.com.br/C%C3%B3digo-limpo-Robert-C-Martin/dp/8576082675?__mk_pt_BR=%C3%85M%C3%85%C5%BD%C3%95%C3%91&amp;keywords=clean+code&amp;qid=1588968796&amp;sr=8-1&amp;linkCode=ll1&amp;tag=vepo0f-20&amp;linkId=936ea100df5aa63c041438ac166948ed&amp;language=pt_BR&amp;ref_=as_li_ss_tl">C√≥digo Limpo: Habilidades Pr√°ticas do Agile Software</a> de Robert C. Martin</li>
</ol>]]></content><author><name>{&quot;twitter&quot;=&gt;&quot;vepo&quot;, &quot;linkedin&quot;=&gt;&quot;https://www.linkedin.com/in/victorosorio/&quot;, &quot;picture&quot;=&gt;&quot;/assets/images/me.avif&quot;}</name></author><category term="Domain-Driven Design" /><category term="DDD" /><category term="Arquitetura de Software" /><category term="Desenvolvimento de Software" /><summary type="html"><![CDATA[Uma introdu√ß√£o ao termo Linguagem Onipresente baseada no livro Domain-Driven Design.]]></summary></entry></feed>